---
title: "Computer Lab 3"
author: "Tim Yuki Washio"
date: "11/19/2020"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(ggplot2)
```

# Question 1: Stable Distribution 

## 1.

Plotting $f(x)$ with $c=2$ and $f_p(x)$ with $\alpha=2$ and $T_{min}=2$

```{r plot}
c = 2
t_min = 1.5
alpha = 1.1

plot(1, xlim = c(0,75), ylim = c(0, 1), type = "n", xlab = "", ylab = "", main = "f(x) ~ f_p(x)")
curve(eval(c) * (sqrt(2 * pi)^(-1)) * exp(-eval(c)^(2) / (2 * x)) * x^(-3/2), from=0, to=75, add=TRUE, col="black")
curve((eval(alpha) - 1 / eval(t_min)) * (x / eval(t_min))^(-eval(alpha)), from=0, to=75, add=TRUE, col="red")

legend("topright", inset=.02, title="functions",
       c("target","majorizing"), horiz=TRUE, cex=0.8, col = 1:2, lty = 1)
```

The power-law distribution should not be used by itself because for small values of $x$ $f_p(x) = \infty$. If we sample from our majorizing distribution in this area, we will get a huge number of rejections. It might be better to combine the power-law distribution with another distribution that majorizes our target function in that area. We could use a uniform distribution with support $(0, T_{min}$ in addition to our given distribution with support $(T_{min}, \infty)$.

Power-law distribution values:

$$\frac{df(x)}{dx} = \frac{ce^{(-c^2)/2x} (c^2-3x)}{2\sqrt(2\pi) x^{7/2}}$$

This has one root for $c \neq 0, x = \frac{c^2}{3}$.

$$max(f(x)) = f(\frac{c^2}{3})$$
$$f_{p}(x) = f(\frac{c^2}{3})$$

$$x = T_{min}$$

# Question 2: Laplace Distribution

To get to the inverse CDF $F^{-1}(p)$ we first need to get the CDF $F(x)$

$$F(x) = \int_{-\infty}^{x}f(u)du = \left\{
\begin{array}{c l}	
    \frac{1}{2} \rm e(\frac{x - \mu}{\alpha})  & \rm if \enspace  x < \mu\\
     1-\frac{1}{2} \rm e(\frac{x - \mu}{\alpha}) & \rm if \enspace x \ge \mu
\end{array}\right.$$

After transformation, we get

$$F(x) = \frac{1}{2} + \frac{1}{2}sgn(x - \mu)\left(1 - e\left(-\frac{|x-\mu|}{\alpha} \right)\right)$$
Now we calculate the inverse CDF $F^{-1}(p)$ by using the CDF $F(x)$ TODO: Write down the way how to get there!

$$F^{-1}(p) = \mu - \alpha sgn(p-0.5)ln(1-2|p-0.5|)$$

```{r code}
# Given density function
laplace_density <- function(x, mu, alpha) {
  result = (alpha/2)*exp(-alpha*abs(x-mu))
  return(result)
}

# Calculated inverse CDF for Laplace function
laplace_inv_cdf = function(p, mu, alpha){
  result = mu-alpha*sign(p-0.5)*log(1-2*abs(p-0.5))
  return(result)
}

# Random number generation with n=10000, mu=10, alpha=1
n = 10000
unif_sample = runif(n)
sample = laplace_inv_cdf(unif_sample, 10, 1)
sample_density = laplace_density(sample, 10, 1)
```

```{r}
# Plotting the histogram
hist_plot <- ggplot() +
geom_histogram(aes(x = sample, y = ..density..), col = "green", fill="green") +
geom_line(aes(x = sample, y = sample_density), col = "red") +
xlab("Sample values") + ylab("Density values")

hist_plot
```
